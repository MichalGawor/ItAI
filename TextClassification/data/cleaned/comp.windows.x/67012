b'' b'[ article crossposted from hp.windows b'[ author was andy defaria b'[ posted on mon, apr gmt b'' b'for some reason the following code causes my x application to beep whenever i' b"intercept a keystroke and change it's meaning. the intent of this code it to" b'allow "date" fields the following special keys:' b'' b"[tt]:\tinsert today's date" b'[+=]:\tbump day up by one' b'[-_]:\tbump day down by one' b'' b"i hardcoded some dates for this example. perhaps i shouldn't be using an" b'xmtext field for this.' b'' b'//////////////////////////////////////////////////////////////////////////////' b'//' b'// for some reason the following code beeps whenever any of the special keys' b'// of [tt+=-_] are hit. why? the idea of this code is to interpret these' b'// keys having the special meaning implied by the code. i would like to get' b"// rid of the beeping but, as far as i can tell, i'm not doing the beep and" b'// am at a lose as to understanding who and why the beeping is occuring.' b'//' b'//////////////////////////////////////////////////////////////////////////////' b'#include <x11/intrinsic.h' b'#include <xm/xm.h' b'#include <xm/rowcolumn.h' b'#include <xm/mainw.h' b'#include <xm/text.h' b'' b'widget\t\ttoplevel;' b'widget\t\tmainwindow;' b'widget\t\tmainpane;' b'widget\t\tdatefield;' b'xtappcontext\tapplication;' b'' b'void marktoday (widget date) b'char *todaysdate b'xtvasetvalues (date, xmnvalue, todaysdate, null);' b'} marktoday' b'' b'void marktomorrow (widget date) b'char *tomorrowsdate b'xtvasetvalues (date, xmnvalue, tomorrowsdate, null);' b'} marktomorrow' b'' b'void markyesterday (widget date) b'char *yesterdaysdate b'xtvasetvalues (date, xmnvalue, yesterdaysdate, null);' b'} markyesterday' b'' b'void datekeys (widget callingwidget b'widget date,' b'xmtextverifyptr callbackdata) b'// capture the keys [tt-_+=] can change their behaviour. if found' b'// set "doit" to false so x won\'t interpret the keystroke.' b'switch (callbackdata-text-ptr b"case 't': case 't':" b'marktoday (date);' b'callbackdata-doit false;' b'return;' b"case case b'markyesterday (date);' b'callbackdata-doit false;' b'return;' b"case case b'marktomorrow (date);' b'callbackdata-doit false;' b'return;' b'default:' b'return;' b'} switch' b'} datekeys' b'' b'void main (cardinal argc, char *argv b'// initialize xt' b'toplevel xtvaappinitialize (&application, "application", null, b'&argc, argv, null, null);' b'' b'// create the toolface' b'mainwindow xtvacreatemanagedwidget' b'("mainwindow", xmmainwindowwidgetclass, toplevel, null);' b'' b'// create a mainwindow' b'mainpane xtvacreatemanagedwidget' b'("mainpane", xmrowcolumnwidgetclass, mainwindow, null);' b'' b'// create a small text area' b'datefield xtvacreatemanagedwidget' b'("datefield", xmtextwidgetclass, mainpane,' b'xmntopattachment,\txmattach_form,' b'xmnrightattachment,\txmattach_form,' b'xmncolumns,\t\t8,' b'null);' b'' b'// set modifyverifycallback to the datekeys callback' b'xtaddcallback (datefield, xmnmodifyverifycallback,' b'(xtcallbackproc) datekeys, (xtpointer) datefield);' b'' b'// realize the toplevel' b'xtrealizewidget (toplevel);' b'' b'// go into the xtmainloop' b'xtappmainloop (application);' b'} main' b'' b'_______________________________________________________________________________' b'i swear by my life and the love of it that i will andrew defaria' b'never live for the sake of another man nor ask hewlett packard' b'another man to live for mine. california language labs' b'_______________________________________________________________________________' b'' b'' b'--' b'_______________________________________________________________________________' b'i swear by my life and the love of it that i will andrew defaria' b'never live for the sake of another man nor ask hewlett packard' b'another man to live for mine. california language labs' b'_______________________________________________________________________________' 