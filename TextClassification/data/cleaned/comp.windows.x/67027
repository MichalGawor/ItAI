b'' b'hi, experts,' b'' b"i'm kind of new to x. the following question is strange to me. i am" b'trying to modify the contents of the colormap but failed without' b'reason (to me). i am using the following piece of code:' b'' b'' b'toplevel xtinitialize(argv[0], "testcolor", null, b'&argc, argv);' b'dpy xtdisplay(toplevel);' b'scr defaultscreen(dpy);' b'def_colormap defaultcolormap(dpy,scr);' b'' b'if(xalloccolorcells(dpy, def_colormap, true, null, cells, b'color.pixel cells[0];' b'color.red b'color.green b'color.blue b'color.flags dored dogreen doblue;' b'xstorecolor(dpy, def_colormap, &color);' b'printf("\\n try to allocate, the color %d as (%d,%d,%d)",' b'color.pixel, color.red, color.green, color.blue);' b'' b'xquerycolor(dpy, def_colormap, &color);' b'printf("\\n after allocate, the color %d is (%d,%d,%d)",' b'color.pixel, color.red, color.green, color.blue);' b'}' b'else' b'printf("\\n error: couldn\'t allocate color cells");' b'' b'' b'running output:' b'' b'try to allocate, the color as b'after allocate, the color is b'' b'after xstorecolor(), xquerycolor() just returned the original value.' b'no failure/error displayed but the contents of colormap are obvious' b'unchanged. (i also tried to draw a line using the colors but it' b'turned out to be the unmodified colors.)' b'' b'so what is my problem? how to modify the contents of the colormap?' b'' b'any help/information will be appreciated. please send mail to' b'' b'--------------------------' b'william' b'--------------------------' b'' b'' b'by the way, the following is the environment i am using (output of' b'"xdpyinfo"). it shows the default visual is pseudocolor.' b'' b'version number: b'vendor string: decwindows digitalequipmentcorporation uws4.2' b'vendor release number: b'maximum request size: longwords bytes)' b'motion buffer size: b'bitmap unit, bit order, padding: lsbfirst, b'image byte order: lsbfirst' b'number of supported pixmap formats: b'supported pixmap formats:' b'depth bits_per_pixel scanline_pad b'depth bits_per_pixel scanline_pad b'keycode range: minimum maximum b'number of extensions: b'adobe-dps-extension' b'dpsextension' b'shape' b'mit-shm' b'multi-buffering' b'xinputextension' b'mit-sundry-nonstandard' b'dec-xtrap' b'default screen number: b'number of screens: b'' b'screen b'dimensions: 1024x864 pixels (333x281 millimeters)' b'resolution: 78x78 dots per inch' b'depths b'root window id: 0x29' b'depth of root window: planes' b'number of colormaps: minimum maximum b'default colormap: 0x27' b'default number of colormap cells: b'preallocated pixels: black white b'options: backing-store yes, save-unders yes' b'current input event mask: 0xd0001d' b'keypressmask buttonpressmask buttonreleasemask' b'enterwindowmask substructureredirectmask propertychangemask' b'colormapchangemask' b'number of visuals: b'default visual id: 0x21' b'visual:' b'visual id: 0x21' b'class: pseudocolor' b'depth: planes' b'size of colormap: entries' b'red, green, blue masks: 0x0, 0x0, 0x0' b'significant bits in color specification: bits' b'visual:' b'visual id: 0x22' b'class: grayscale' b'depth: planes' b'size of colormap: entries' b'red, green, blue masks: 0x0, 0x0, 0x0' b'significant bits in color specification: bits' b'visual:' b'visual id: 0x23' b'class: staticgray' b'depth: planes' b'size of colormap: entries' b'red, green, blue masks: 0x0, 0x0, 0x0' b'significant bits in color specification: bits' b'visual:' b'visual id: 0x24' b'class: staticcolor' b'depth: planes' b'size of colormap: entries' b'red, green, blue masks: 0x7, 0x38, 0xc0' b'significant bits in color specification: bits' b'visual:' b'visual id: 0x25' b'class: truecolor' b'depth: planes' b'size of colormap: entries' b'red, green, blue masks: 0x7, 0x38, 0xc0' b'significant bits in color specification: bits' b'number of mono multibuffer types: b'visual id, max buffers, depth: 0x21, b'visual id, max buffers, depth: 0x22, b'visual id, max buffers, depth: 0x23, b'visual id, max buffers, depth: 0x24, b'visual id, max buffers, depth: 0x25, b'number of stereo multibuffer types: b'' 