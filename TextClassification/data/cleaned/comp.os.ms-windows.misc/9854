b'' b'' b'i have a .bat file that i run under a windows icon. i have set up a pif' b'file to run the bat file in exclusive mode and to use the entire screen.' b'the first line of the bat file sets an environment variable.' b'' b'my problem is that on some of our machines (running ms-dos and windows' b'3.1 in enhanced mode), the set command in the bat file fails with the' b'out of environment space error. i have raised the amount of environment' b'space to bytes using the shell command in config.sys so i know that' b'i am nowhere near to running out.' b'' b'(from the windows resource toolkit (for win4workgroups)), add an entry to' b'your "system.ini" file under the [nonwindowsapp] section:' b'' b'commandenvsize=nnnn' b'' b'"this sets the command.com env size, where nnnn must either be or' b'between and a value of disables the setting. if this' b'value is too small or too big, it is rounded up to or down to b'if the value is less than the current size of the actual environment,' b'this setting is disabled, as if it were if you specify the' b'environment size in a pif file for command.com, the pif setting' b'overrides this setting. the default is with msdos versions earlier' b'than otherwise, the default value is the /e: option in the' b'shell= command in config.sys. to set this value, you must edit your' b'system.ini [and reboot]."' b'' b'' b'i have used this entry, as well as relied on the default /e: from' b'the config.sys shell= line, and both give larger environments. if' b"you don't use one of these, then the environment passed by windows" b'to each new dos box is just a little bit bigger than the environment' b'_variables_ present when windows was started. (no matter how big' b'the dos env was, when windows starts, it truncates all unused space' b'except for a few bytes.) this should allow your batch file to run,' b'but your mileage may vary.' b'' b'--' b'aspen technology group uucp: {uunet}!csn!atglab!jls' b'po box ft. collins, co voice: b'' 