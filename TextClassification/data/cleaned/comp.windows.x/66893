b'' b'greetings,' b'' b'' b'i am using an x server that provides visuals:' b'pseudocolor bit, truecolor bit and directcolor bit.' b'' b'a problem occurs when i try to create a window with a visual that is different' b'from the visual of the parent (which uses the default visual which is tc24).' b'' b"in the xlib reference guide from 'o reilly one can read in the" b'section about xcteatewindow, something like:' b'"in the current implementation of x11: when using a visual other than the' b"parent's, be sure to create or find a suitable colourmap which is to be used" b'in the window attributes when creating, or else a badmatch occurs."' b'' b'this warning, strangely enough, is only mentioned in the newer editions' b'of the x11r5 guides.' b'' b'however, even if i pass along a suitable colourmap, i still get a badmatch' b'when i create a window with a non-default visual.' b'the code looks like this:' b'' b"------------------ cut here and you'll destroy your crt b'' b'window create_8bit_window_on_truecolour_display(dpy,width,height)' b'display *dpy;' b'int width, height;' b'{' b'window win;' b'xvisualinfo vinfo;' b'xsetwindowattributes attr;' b'' b'fprintf(stderr,"opening bit window...\\n");' b'if (!xmatchvisualinfo(dpy,defaultscreen(dpy),8,pseudocolor,&vinfo)) b'fprintf(stderr,"your display can\'t handle bit pseudocolor.\\n");' b'exit(1);' b'}' b'fprintf(stderr,"using visual: %x\\n",vinfo.visual-visualid);' b'cmap xcreatecolormap(' b'dpy,' b'defaultrootwindow(dpy),' b'vinfo.visual,' b'allocnone' b');' b'xsync(dpy,false);' b'xinstallcolormap(dpy,cmap);\t/* ommision of this line gives same result b'attr.colormap cmap;' b'win xcreatewindow(' b'dpy,' b'defaultrootwindow(dpy),' b'10,10,' b'width,height,' b'copyfromparent, border width b'8, depth b'inputoutput, class b'vinfo.visual, visual b'cwcolormap,' b'&attr' b');' b'return win;' b'}' b'' b"--- cut here and you'll destroy your crt b'' b'executing this piece of code results in a badmatch error.' b'anybody who knows why?' b'if so, please drop me a line.' b'' b'' b'' b'take care,' b'' b'' b'bram stolk' 