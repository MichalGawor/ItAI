b'' b'the one-time-pad yeilds ideal security, but has a well-known flaw in' b'authentication. suppose you use a random bit stream as the pad, and' b'exclusive-or as the encryption operation. if an adversary knows the' b'plaintext of a message, he can change it into any other message.' b"here's how it works." b'' b'alice is sending bob a plaintext p, under a key stream s' b'alice computes the ciphertext c s xor p, and sends it to bob.' b'' b"eve knows the plainext p, but wants the message to appear as p'." b"eve intercepts c, and computes c' c xor p xor p' s xor p'." b"eve sends c' to bob." b'' b"bob decrypts c' by computing c'xor s p', thus receiving the" b'false message which was substituted by eve.' b'' b'firstly, an aside:' b'' b'i agree that the weakness exists, but i have a lot of trouble' b'believing that it represents a difficulty in real life. given:' b'' b'1. the purpose of the one-time pad is to give unbreakable security,' b'and the expense of key distribution etc., imply that the clients' b'really do want that level of security' b'' b'2. these same people want to keep p a secret' b'' b'i find it hard to believe that eve might happen to have a copy of p' b'lying around.' b'' b'(i am aware that the same argument applies to eve knowing even a small' b'part of the message, but eve must know exactly where (which bytes) in' b'c her known susequence starts, or the result will be garbled. i find' b'this at least as surprising.)' b'' b'back to the question:' b'' b'if i had the resources to use a one-time-pad for such transmissions, i' b'would also append a message authentication code to the message, using up' b'the next bits of the one-time-pad as the key perhaps. your original' b'question basically asked whether there was any way to authenticate the' b'message with the same degree of security as the pad itself provided,' b"and i don't know the answer. however, i would propose the following" b'for discussion.' b'' b'alice and bob have an arbitrary number of secret, random bits to' b"share, which eve doesn't know. she finds them out (effectively) by" b'knowing some p and the corresponding c. it is the fact that they' b'correspond that causes the problem. if a message authentication code was to' b'be created using some one-time-pad operation such that eve could not' b'know which parts of the mac were affected by which parts of the input,' b'she would be unable to forge a mac to correspond.' b'' b'what is required is a non-linear combiner of parts of the message.' b"(non-linear so that simply xoring or subtracting or whatever doesn't" b'have exactly the same effect).' b'' b'now, at the end of the encrypted message c, alice appends a n-bit mac' b'computed as follows (s2 means the next full chunk of the one time pad):' b'1. compute c2 p xor s2, and pad to an n-bit boundary with more of s' b'2. break c2 into n-bit chunks' b'3. set mac to (initialisation vector)' b'4. for i in each chunk sequentially' b'set mac mac nlop c2[i]' b'' b'at the end of this process mac is the message authentication code.' b'' b'(bob verifies the mac in the obvious manner; he recovers the' b'plaintext p, then uses some more of his pad to reproduce the mac in' b'the same manner.)' b'' b'nlop is the non-linear operator, and there is the rub. the simplest' b'non-linear operator i can think of is an s-box; that is, have a fixed' b'(even published) permutation of the n-bit integers, an indexable table' b'called sbox, and use:' b'x nlop y x xor sbox[y].' b'' b'practically speaking, i think this solves your problem, as eve never' b"sees the intermediate output c2, and hence can't deduce s2 or perform any valid" b'substitution on it.' b'' b'also practically speaking, you want the mac to be fairly large, say b'bits, but you might not want a gigabyte (say) s-box, so you might' b'work on byte-sized s-boxes, but i think that is an irrelevant detail' b'for the discussion at hand.' b'' b'who will be first to point out my errors, or give me a pointer to some' b'literature?' b'--' b'greg rose australian computing and communications institute' b'`use of the standard phrase "hijacked" may be inadvisable\' caa' 