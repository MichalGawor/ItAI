b'' b'' b" can someone who knows what they're talking about add a faq entry" b' on gamma correction? thanks.' b'' b'i get regular questions about gamma correction since i go to great pains to' b'deal with it properly in xli (the image loader program i maintain).' b'' b'here is an explanation i often use to answer these questions.' b'' b'this might be suitable for inclusion in the faq.' b'' b'graeme gill.' b'' b'###########################################################################' b'"a note on gamma correction and images"' b'' b'author: graeme w. gill' b'' b'date: b'' b'' b'"what is all this gamma stuff anyway b'--------------------------------------' b'' b'although it would be nice to think that "an image is an image",' b'there are a lot of complications. not only are there a whole bunch of' b'different image formats (gif, jpeg, tiff etc etc), there is a whole' b'lot of other technical stuff that makes dealing with images a bit' b"complicated. gamma is one of those things. if you've ever downloaded" b"images from bbs or the net, you've probably noticed (with most image" b'viewing programs) that some images look ok, some look too dark, and some' b'look too light. "why is this you may ask. this, is gamma correction' b'(or the lack of it).' b'' b'why do we need gamma correction at all b'--------------------------------------' b'' b'gamma correction is needed because of the nature of crts (cathode' b'ray tubes the monitors usually used for viewing images). if you' b'have some sort of real live scene and turn it into a computer' b'image by measuring the amount of light coming from each point of' b'the scene, then you have created a "linear" or un-gamma-corrected' b'image. this is a good thing in many ways because you can manipulate' b'the image as if the values in the image file were light (ie. adding' b'and multiplying will work just like real light in the real world).' b'now if you take the image file and turn each pixel value into a voltage' b"and feed it into a crt, you find that the crt _doesn't_ give you" b'an amount of light proportional to the voltage. the amount of light' b'coming from the phosphor in the screen depends on the the voltage' b'something like this:' b'' b'light_out voltage crt_gamma' b'' b'so if you just dump your nice linear image out to a crt, the image' b'will look much too dark. to fix this up you have to "gamma correct"' b'the image first. you need to do the opposite of what the crt' b'will do to the image, so that things cancel out, and you get' b'what you want. so you have to do this to your image:' b'' b'gamma_corrected_image image (1/crt_gamma)' b'' b'for most crts, the crt_gamma is somewhere between and b'' b'if that is all it is, why does it seem so complicated b'-----------------------------------------------------' b'' b'the problem is that not all display programs do gamma correction.' b'also not all sources of images give you linear images (video cameras' b'or video signals in general). because of this, a lot of images' b'already have some gamma correction done to them, and you are' b'rarely sure how much. if you try and display one of those images' b'with a program that does gamma correction for you, the image gets' b'corrected twice and looks way to light. if you display one of those' b"images with a program that doesn't do gamma correction, then it will" b'look vaguely right, but not perfect, because the gamma correction is' b'not exactly right for you particular crt.' b'' b'whose fault is all this b'-----------------------' b'' b'it is really three things. one is all those display programs' b"out there that don't do gamma correction properly. another is" b"that most image formats don't specify a standard gamma, or" b"don't have some way or recording what their gamma correction is." b'the third thing is that not many people understand what gamma' b'correction is all about, and create a lot of images with varying' b"gamma's." b'' b'at least two file formats do the right thing.' b'the utah graphics toolkit .rle format has a semi-standard way of recording' b'the gamma of an image. the jfif file standard (that uses jpeg compression)' b'specifies that the image to be encoded must have a gamma of (ie. a' b'linear image but not everyone obeys the rules).' b'' b'some image loaders (for instance xli an x11 image utility)' b'allow you to specify not only the gamma of the monitor you' b'are using, but the individual gamma values of image you are trying to' b'view. other image viewers (eg. xv another x11 image program) and' b'utilities (eg. the pbm toolkit) provide ways of changing the gamma' b'of an image, but you have to figure out the overall gamma correction' b'yourself, allowing for undoing any gamma correction the image has,' b'and then the gamma correction you need to suite your crt monitor.' b'' b"[ note that xv doesn't provide an easy way of modifying the" b'gamma of an image. you need to adjust the r, g and b curves to the' b'appropriate gamma in the coledit controls. altering the intensity' b"in the hsv controls doesn't do the right thing, as it fails to" b'take account of the effect gamma has on h and s. this tends' b'to give a tint to the image. b'' b'how can i figure out what my viewer does, or what gamma my screen has b'---------------------------------------------------------------------' b'' b'the simplest way to do that is to try loading the file chkgamma.jpg' b'(provided with xli distribution), which is a jfif jpeg format file' b'containing two grayscale ramps. the ramps are chosen to look linear' b'to the human eye, one using continuous tones, and the other using' b'dithering. if your viewer does the right thing and gamma corrects' b'images, then the two ramps should look symmetrical, and the point' b'at which they look equally bright should be almost exactly half' b'way from the top to the bottom. (to find this point it helps if' b'you move away a little from the screen, and de-focus your eyes a' b'bit.)' b'' b"if your viewer doesn't do gamma correction, then left hand ramp will have" b'a long dark part and a short white part, and the point of equal brightness' b'will be above the center.' b'' b'if your viewer does have a way of setting the right amount of gamma correction' b'for a display, then if the equal brightness point is above center increase the' b'gamma, and decrease it if it is below the center. the value will usually be' b'around b'' b'[with xli for instance, you can adjust the display gamma with the' b"-dispgamma flag, and once you've got it right, you can set the display_gamma" b'environment variable in your .profile]' b'' b'how do i figure out what the gamma of an image is b'-------------------------------------------------' b'' b'this is the most tricky bit. as a general rule it seems that a lot of' b'true color (ie. bit, .ppm .jpg) images have a gamma of' b'1.0 (linear), although there are many about that have some gamma' b'correction. it seems that the majority of pseudo color images' b'(ie. bit images with color maps .gif etc.) are gamma corrected' b'to some degree or other.' b'' b'if your viewer does gamma correction then linear images will' b'look good, and gamma corrected images will look too light.' b'' b"if your viewer doesn't do gamma correction, then linear images will" b'look too dark, and gamma corrected images will ok.' b'' b'why linear images are sometimes not such a good thing' b'-----------------------------------------------------' b'' b'one of the reason that many high quality formats (such as' b'video) use gamma correction is that it actually makes better' b'use of the storage medium. this is because the human' b'eye has a logarithmic response to light, and gamma correction' b'has a similar compression characteristic. this means images' b'could make better use of bits per color (for instance),' b'if they used gamma correction. the implication though, is that' b'every time you want to do any image processing you should' b'convert the bit image to or so linear bits to retain' b'the same accuracy. since little popular software does this, and' b'none of the popular image formats can agree on a standard' b'gamma correction factor, it is difficult to justify gamma corrected' b'images at the popular level.' b'' b'if some image formats can standardize on a particular gamma,' b'and if image manipulation software takes care to use' b'extra precision when dealing with linearized internal data,' b'then gamma corrected distribution of images would be a good thing.' b'' b'(i am told that the kodak photocd format for instance, has a' b'standard gamma correction factor that enables it to get the' b'highest quality out of the bits used to hold the image).' b'' b'###########################################################################' b'' b'' 