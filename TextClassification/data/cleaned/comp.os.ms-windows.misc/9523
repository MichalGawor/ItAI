b'' b'' b": i have normal procomm plus for dos, but i've been considering buying" b': the windows version....it got really great reviews in computer shopper.' b': i have a friend who connects to the mainframe and unix machines here' b': using it, but the screen seems to have a problem keeping up with the' b": modem....he has a modem on a mhz machine. i can't" b': see it having trouble keeping up. his pcplus for dos works great,' b'' b're: what to do after the high speed modem arrives. edition apr b'' b'this article applies only to windows and and not to nt, os/2' b'or dos apps not running under windows.' b'' b'one of the unadvertised limitations of most current windows pcs is that' b'their rs-232c (serial, com) performance is seriously deficient. almost' b'everyone who purchases a high-speed modem (v.32bis, v.32, pep or hst)' b'discovers the problem the first time they try to download a file or accept' b'an incoming fax (at after upgrading the modem. overrun and retry' b'errors abound, even when the only active application is the datacomm or' b'fax program. if the transfer completes at all, it may take even longer' b'than with the old 2400bps modem.' b'' b'' b'there are three reasons for the problem:' b'' b'1. the universal asynchronous receiver/transmitters (uarts) used in most' b'pcs are primitive ns8250 devices with single-byte fifo buffers. if the' b'operating system/driver cannot read and flush each character at high' b'interrupt rates, the next incoming character overwrites the fifo and' b'the previous one is lost. dos, being a fairly single-minded' b"environment during datacomm, can usually keep up. windows can't." b'' b'2. windows has more operating system overhead than plain dos, and' b'interrupts often take longer to service. overruns are much more likely' b'than under dos. as soon as you report to your pc/modem vendor that you' b'are losing data, you may be advised that "you need to upgrade to a' b'16550". more likely, since there seems to be a conspiracy of ignorance' b"about this issue, you'll get no useful advice at all. most of the" b'store-front and mail-order sources i spoke with in attempting to solve' b'my own problem had never heard the term and many didn\'t even' b'know what a uart was.' b'' b"3. even your pc has ns16550a uarts (and ps/2's do), or if you can upgrade" b'your mother/com board or add a new com board, you may still experience' b'errors and overruns because the standard microsoft windows com drivers' b"don't take full advantage of the windows is improved in this" b'regard over but i still recommend a driver upgrade. applications' b'like procomm+/win (which is what i use) cannot get around this problem' b'by themselves.' b'' b'if you have a modem card, you may not have a problem, as the modem part of' b'the card can be designed to be aware of the state of the uart, and avoid' b"overrunning it; however, i wouldn't want to bet that the card designers" b'were that clever, and will insist on a uart if i ever buy a modem' b"card. some modem cards don't even have conventional uarts, but if they" b'are to work with standard windows drivers, they need to simulate one.' b'use msd.exe (below) to see what the modem card is, or is pretending to be.' b'' b'' b'the hardware situation.' b'' b'the uarts on most pc com ports are based on national semiconductor ns8250' b"or ns16450 chips (or megacells inside vlsi chips where you can't replace" b'them). you can id the uart type on your system by running the microsoft' b'diagnostic program \\windows\\msd.exe. be sure to run it in dos *before*' b'bringing up windows. the windows serial api may prevent msd from' b'accurately identifying a if you run it from a windows dos prompt.' b'' b'the ns16550 uart has separate 16-byte transmit and receive fifos with' b'configurable trigger levels, and can run reliably at clock rates up to' b"460,800 bps, although with current modem technology, there's no point in" b'pushing your luck by going over bps. the has shorted access' b'cycle times than the or the also has dma capability, but' b'it is not clear that any pc drivers ever use this. for more technical info,' b'see national semiconductor application note an-491.' b'' b'so, what uart component do you have?' b'' b'try to locate the uart on your mother board, multi-function i/o card, com' b"board or isa/mca modem card. if you can't find a socketed component with" b'the numbers or your com ports are probably buried in vlsi,' b"and you won't be able to perform a chip replacement. if you can disable" b'your vlsi com ports (as i chose to do), you can at least add an aftermarket' b'com board.' b'' b'if you have one or more socketed or chips, you can buy plug-in' b'ns16550afn or pc16c550cn (low power cmos version) ics from several' b'suppliers typically for to each. the "n" chip is the normal 40-pin' b'dual-in-line package. other styles are available, but avoid any ns16550' b'chips without the "a" (the 16c550c are presumably all ok).' b'' b'early ns chips have bugs, although national will reportedly exchange those' b'of their own manufacture for free. clone chips are available from various' b'ic makers other than national. the manual for the turbocom drivers states' b'support for the following (apparently equivalent) chips:' b'national semiconductor: 16550a, b'chips&technology: 82c607' b'texas instruments: t16c550a' b'silicon systems: 73m550' b'vlsi 16c550' b'turbocom warns about the pre-"a" ns16550 and western digital 16c550,' b'says that problems have been reported with early ibm ps/2 55sx and b'systems (ibm reportedly will upgrade them).' b'' b"if you don't have socketed chips, you'll need to buy an after-" b'market com or multi-function board. if this is a modem card situation, you' b"may be hosed. to add a new com or multi-function card, you'll need to" b'either disable the com1/2 port(s) you are replacing, or re-assign them to' b'com3/4 (although watch out for irq conflicts without turbocom).' b'' b'although cheaper cards are available, in the interest of getting the' b'problem solved quickly i elected buy the modular circuit technology' b'mct-aio+ card from:' b'' b'jdr microdevices' b'2233 samaritan drive' b'san jose ca b'(800) voice us' b'(408) voice other' b'(800) fax us' b'' b'the mct-aio+ (and the is important) sells for it is an 8-bit' b'isa card providing:' b'' b'port type connector address and irq comments' b'com db9m com irq ns16550afn in socket' b'com ribbon com irq ns16550afn in socket' b'parallel db25f lpt1,2,3 irq b'game ribbon' b'' b'the kit includes a ribbon cable and db25f connector for the secondary com' b'port, a ribbon cable/connector for the game port, two bulkhead plates for' b'the ribbon-based connectors and a 9f-to-25f adaptor cable. each port can' b'be individually disabled, and the com ports have tx, rx, rts, cts, dtr,' b'dcd, and dsr jumpers.' b'' b'jdr also sells a super-i/o m-f card that also has ide.' b'' b'i have heard from several people about less expensive m-f i/o cards' b'with 16550s:' b'' b'tsd systems' b'(407) b'$19.95 for the card, plus per b'' b'greenfield trading and distributors' b'(518) (voice), 271-7811(fax).' b'their card is w/one w/2, and they sell 16550afns for b'' b'r&s data systems, inc.' b'820 east highway b'longwood, fl b'phone: b'fax: b'2com/lpt/game card w/2 16550s for b'' b'i have no personal experience with any of the firms except jdr.' b'' b'meanwhile, back at the mct card from jdr... i only needed two serial ports,' b'and am running out of irqs on my pc, so i disabled my built-in vlsi-based' b'8250 ports. however, with the turbocom driver (below), i could have set' b'the internals as com3 and using irq sharing.' b'' b'' b'the software situation' b'' b'simply upgrading to uarts will not completely solve common overrun' b"problems. the standard ms serial drivers don't take full advantage of the" b'16550. the windows drivers are even less capable, and the windows b'drivers have the following limitations:' b'- they enable only the receive fifo, and only at rates above bps.' b'- they never enable the transmit fifo, which results in an interrupt' b'rate of 10x during uploads.' b"- they set the trigger level at bytes (too high it's easy for b'more bytes to arrive before the driver can read the fifo).' b'- the ports menu of the control panel only allows speeds up to b'with a v.32bis modem, sparse data and text can easily compress b'or more, suggesting that a host dte connect rate of bps would' b'be effective.' b'- the api won\'t accept rates above "cbr_128000".' b"- the api won't let dos programs know there is a there, and even" b"if it did, dos programs that aren't 16550-aware get little benefit" b'from a port with the standard drivers.' b"- they don't allow irq sharing for com3,4." b"- the bios doesn't initialize com3,4 properly in many systems." b"- windows provides no workaround for apps that don't provide port" b'speed options above bps.' b'' b'these problems are reportedly not solved in windows nt or dos and may' b'or may not be addressed in any windows releases after (but before b'rumors suggest they "may" be solved in windows b'' b'you can get replacement drivers that solve all of those problems by buying' b'a copy of "turbocom", current version from:' b'' b'bio-engineering research' b'pacific commware division' b'180 beacon hill lane' b'ashland or b'(503) voice' b'(503) fax' b'(503) bbs' b'mcimail: b'compuserve: b'' b'price was around as i recall. bio-eng is not set up to accept credit' b'cards, so i had to send a check. egghead and 1-800-software list turbocom' b"but as far as i know, they don't stock it. bio is not a software company" b'per se. they apparently needed reliable hi-speed serial connections for' b'an in-house instrument application, wrote their own driver, discovered a' b'market for it, revised it to be a general purpose com driver suite. they' b'recently upgraded it for windows it is run-time licensed.' b'' b'i now have my host (dte) connect rate set to bps most of my' b'datacomm apps, and i am having zero problems with downloads. i routinely' b'see transfer rates that exceed bps. i am also using bps' b'when linking an hp95lx to my pc, with lossless bi-directional i/o.' b'uploads to various remote systems are another matter, because many hosts' b'are still using antique uarts and drivers.' b'' b'note that is still the highest rate that the windows port menu' b'in control panel will allow in configuring a com port. turbocom gets' b'around this by allowing you to specify, on each port, a factor that will' b'set the real uart rate to a multiple of the rate passed through the' b'windows apis and dialog boxes.' b'' b'i also have cts/rts hardware flow control enabled, and i suggest that you' b'do the same. even if you only ever transfer 7-bit ascii data, xon/xoff is' b'not a sufficiently reliable method of flow control. the informal (dec)' b'standard for xon/xoff hysteresis is that the sender may transmit another' b'16 (yes, sixteen) bytes after receipt of the xoff from the receiving' b'system or device. the byte fifo in the is clearly not big enough' b'to let us rely exclusively on xon/xoff. a well-respected datacomm' b"engineer has informed me that the 16550's can't really do cts/rts all" b'by itself in the dos/windows environment, so using data rates above' b'115,200 may still be risky.' b'' b'even with hardware flow control, a with turbocom can still' b'experience overruns in very busy systems, with lots of apps running and' b'serious swapping in progress. if this is your situation, you may need to' b'buy a co-processed com board, but this will cost you more than a' b'16550/turbocom upgrade. a review of two such boards, and a review of' b'turbocom, can be found in the feb\'93 issue of "windows sources" magazine.' b'i suggest trying a 16550/turbocom upgrade first, and experiment with' b'process priorities and time slices if you are a "power user" whose' b'thrashing system still runs into comm problems.' b'' b'' b'closing soapbox comments' b'' b'the state of rs-232c serial datacomm support is an embarrassment across' b'the computer industry. because it is the oldest standard i/o interface,' b'the job of designing hardware and writing software often seems to be' b'assigned to the least senior or lowest ranked engineers at computer' b'companies. the design of the average serial port is at least ten years' b'behind the state of the art. in my last job, with a major workstation' b'vendor, i lobbied for improved serial ports when they were doing the' b'initial designs of a new system. that family of machines was' b'subsequently introduced with ports. however, this is the' b'exception. few computer companies seem to have any champions for decent' b'i/o.' b'' b'you may as well learn what you can about serial i/o, because this' b'situation shows no sign of improving soon. when v.fast arrives, i expect' b'cries of outrage from windows users world-wide whose pcs "sort of"' b'work today with v.32, but will fail miserably with v.fast. without a' b'hardware-buffered uart (like the and without software drivers that' b'use that uart to best advantage, a v.fast modem will be a waste of money.' b'' b'regards, 1001-a east harmony road' b'bob niland suite b'compuserve: b'' b'copyright robert j. niland' b'all rights reserved' b'' b'permission is granted for automatic redistribution of this article, via' b'electronic, magnetic and optical media, in an unedited form, through any' b'usenet newsgroup where the article is posted by the author. permission' b'is granted for each compuserve and usenet reader subscriber and each' b'person who received this article from compuserve, an ftp site authorized' b'by the author or via electronic mail from the author, to retain one' b'electronic copy and to make hardcopy reproductions of this edition of' b'this article for personal non-commercial use, provided that no material' b'changes are made to the article or this copyright statement. all other' b'copying, storage, reproduction or redistribution of this article, in' b'any form, is prohibited without the express written consent of the' b'author, robert j. niland.' b'' b'eof' 