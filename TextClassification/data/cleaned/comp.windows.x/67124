b'' b'a few days ago i posted a question about trying to call a function which set' b'up an x app multiple times. it was pointed out that xtappinitialize() should' b'never be called more than once. this helped. however, i am still having' b'some problems. below is a new little test program that more closely models' b'my real program. in the actual program, i am writing a library, callable' b'from any other program. this means that the first time the lib function is' b'called, it must initialize things, and after that, it should just use the' b'old stuff (still around because of static variables). in the demo below,' b'main() represents the main program calling my library and doit() represents' b'the interface to the library function.' b'' b'#include <x11/xlib.h' b'#include <xm/xm.h' b'#include <xm/pushb.h' b'#include <stdio.h' b'#include <stdlib.h' b'' b'void bla(xtappcontext app, widget top)' b'{' b'widget topone top;\t\t// in real prog, these are member vars' b'xtappcontext theapp app;\t// of a class' b'int junk b'display *dis xtopendisplay(theapp, null, null, null, null, &junk,' b'null);' b'' b'widget box xtvacreatemanagedwidget("blaaa", xmpushbuttonwidgetclass,' b'topone,' b'xmnheight, b'xmnwidth, b'null);' b'' b'xtrealizewidget(topone);' b'for (int i=0;i<=25;i++)\t// real prog returns when "exit" button clicked' b'{' b'xevent event;' b'xtappnextevent(theapp, &event);' b'xtdispatchevent(&event);' b'}' b'xtdestroywidget(box);' b'xtclosedisplay(dis);' b'}' b'' b'// setitup should be called once only' b'void setitup(xtappcontext *app, widget *top)' b'{' b'int junk b'(*top)=xtappinitialize (app, "test", null, &junk, null,' b'null, null, b'}' b'' b'// doit some library function callable from the outside' b'void doit()' b'{' b'static xtappcontext app;\t// use these every time called' b'static widget top;' b'' b'static int setup b'' b'if (!setup)' b'{' b'setitup(&app, &top);' b'setup b'}' b'bla(app, top);' b'}' b'' b'// main program which links to my library' b'main()' b'{' b'for (int i=0;i<=20;i++)' b'{' b'doit();' b'printf("sleeping...\\n");//widget still on screen at this point' b'sleep(5);' b'}' b'}' b'' b'' b'the problem is that the widget does not go away until the new one is created.' b'(it is still on the screen unusuable during the "sleep" in the main prog,' b'despite the xtdestroywidget call).' b'' b"anyone see something i'm missing?" b'' b'thanks very much.' b'' b'(please respond via email)' b'--' b'-------------------------------------------------------------------------------' b'-------------------------------------------------------------------------------' 